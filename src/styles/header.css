/* ===== ヘッダー（固定） ===== */
header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: #333333;
  color: #ffffff;
  padding: 10px 20px;
  display: flex;
  align-items: center;
  box-sizing: border-box;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
}

/* タイトル（ブランドはクリック可） */
header h1 {
  font-size: 1.8rem;
  font-weight: bold;
  margin: 0 20px 0 0;
}
header .brand { cursor: pointer;
  user-select: none;
  transition: opacity .2s ease, transform .2s ease;
}
header .brand:hover,
header .brand:focus-visible {
  opacity: .9;
  transform: translateY(-1px);
  outline: none;
}
/* ===== ナビゲーション ===== */
nav {
  flex-grow: 1;
  display: flex;
  justify-content: flex-end;
}
nav ul {
  display: flex;
  list-style: none;
  gap: 0;
  margin: 0;
  padding: 0;
  align-items: center;
}
nav ul li {
  position: relative; /* ドロップダウンの基準 */
}

nav ul li button {
  background: none;
  border: none;
  color: #ffffff;
  font-size: 1rem;
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 6px;
  transition: color 0.25s ease, transform 0.25s ease, background-color .2s ease;
}

nav ul li button:hover,
nav ul li button:focus-visible {
  text-decoration: underline;
  color: #f39c12;
  transform: scale(1.06);
  outline: none;
  background-color: rgba(255,255,255,0.06);
}

/* ===== ドロップダウン（プロジェクト） ===== */
.has-dropdown .dropdown {
  position: absolute;
  top: calc(100% + 8px);
  left: 0;
  min-width: 200px;
  padding: 8px;
  display: none;                /* 初期は非表示 */
  background: #222;             /* ダーク基調 */
  color: #fff;
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  box-shadow: 0 12px 28px rgba(0,0,0,0.35);
  z-index: 1001;
}

.has-dropdown:hover .dropdown,
.has-dropdown:focus-within .dropdown {
  display: block;
}

.dropdown li {
  margin: 2px 0;
}
.dropdown li button {
  width: 100%;
  text-align: left;
  padding: 10px 10px;
  border-radius: 8px;
  color: #e8e8e8;
  transition: background-color .2s ease, transform .15s ease;
}
.dropdown li button:hover,
.dropdown li button:focus-visible {
  background: rgba(255,255,255,0.08);
  transform: translateX(2px);
  text-decoration: none;
  outline: none;
}

/* ===== PC（マウス環境）専用：隙間に“透明の橋”をかける。クリックは有効のまま ===== */
@media (hover: hover) and (pointer: fine) {
  /* クリック（focus）で開きっぱなしにしない */
  .has-dropdown:focus-within .dropdown { display: none; }

  /* hover中だけ開く（dropdown 上に乗っても開いたまま） */
  .has-dropdown:hover .dropdown,
  .has-dropdown .dropdown:hover { display: block; }

  /* 隙間 8px を hover 判定できる透明帯で埋める（見た目は変えない） */
  .has-dropdown { position: relative; }
  .has-dropdown .dropdown {
    /* ここは現状のまま（例：top: calc(100% + 8px);）でOK */
    /* pointer-events はいじらない（クリックを有効のままにする） */
  }
  .has-dropdown .dropdown::before {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    top: -8px;   /* ← 隙間の高さに合わせる（現状 8px） */
    height: 8px; /* ここを隙間ぶんに */
    /* 透明のまま hover を拾う。クリックはこの帯では発生しないゾーンなので問題なし */
    pointer-events: auto;
  }
}

/* ===== レスポンシブ ===== */
@media (max-width: 768px) {
  header {
    padding: 15px 16px;
  }

  header h1 {
    font-size: 1.2rem;
    margin-right: 8px;
  }

  nav ul {
    gap: 4px;
    flex-wrap: nowrap;
    justify-content: flex-end;
  }

  nav ul li button {
    font-size: 0.78rem;
    padding: 2px 4px;
    transform: none !important;
    text-align: right;
  }

  .has-dropdown .dropdown {
    position: static;
    display: none;
    width: 100%;
    min-width: 0;
    margin-top: 6px;
    padding: 6px;
    border-radius: 8px;
    background: #2a2a2a;
    box-shadow: none;
  }
  .has-dropdown:focus-within .dropdown,
  .has-dropdown:hover .dropdown {
    display: block;
  }
}

/* さらに狭い場合の微調整 */
@media (max-width: 420px) {
  header h1 {
    font-size: 1rem;
    padding: 5px;
  }
  nav ul li button {
    font-size: 0.65rem;
    padding: 1px 2px;
  }
}

/* ===== 1) ヘッダーの縦の太さを固定（フォントや余白は現状のまま） ===== */
:root { --header-height: 64px; } /* 必要に応じて 60–72px で微調整OK */
header { height: var(--header-height); }
@media (max-width: 768px) { header { height: var(--header-height); } }
@media (max-width: 420px) { header { height: var(--header-height); } }

/* ===== 2) 縮小時のドロップダウンをヘッダーのフロー外に（巻き込み防止） ===== */
@media (max-width: 768px) {
  /* アンカーは親 <li> に */
  .has-dropdown { position: relative; }

  /* 既存の position: static; width:100% を上書きしてオーバーレイ表示に */
  .has-dropdown .dropdown {
    position: absolute !important;      /* ← フローから外す（ヘッダー高さに影響させない） */
    top: calc(100% + 8px);              /* 既存の隙間 8px を維持 */
    right: 0;
    left: auto;
    width: auto;                         /* 100% を解除 */
    min-width: 200px;
    max-width: min(92vw, 320px);         /* 画面外に出ないように制限 */
    z-index: 1001;
    /* 背景色・パディング・角丸などは既存指定をそのまま活かす */
  }

  /* スマホは hover 検出の副作用を避け、タップ（focus-within）のみで開く */
  .has-dropdown:hover .dropdown { display: none !important; }
  .has-dropdown:focus-within .dropdown { display: block !important; }
}
